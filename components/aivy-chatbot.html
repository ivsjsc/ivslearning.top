<!-- AIVY AI Chatbot Floating Component -->
<div id="aivy-chatbot-container" class="aivy-container">
    <!-- Floating Button -->
    <button id="aivy-toggle-btn" class="aivy-toggle-btn" title="Chat v·ªõi AIVY - AI Assistant">
        <div class="aivy-icon">
            <i class="fas fa-robot"></i>
        </div>
        <span class="aivy-badge">1</span>
    </button>

    <!-- Chat Window -->
    <div id="aivy-chat-window" class="aivy-chat-window">
        <!-- Header -->
        <div class="aivy-header">
            <div class="aivy-header-content">
                <div class="aivy-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="aivy-title-section">
                    <h3 class="aivy-title">AIVY Assistant</h3>
                    <p class="aivy-status">üü¢ Online & Ready</p>
                </div>
            </div>
            <button id="aivy-close-btn" class="aivy-close-btn" title="ƒê√≥ng chat">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Messages Container -->
        <div id="aivy-messages" class="aivy-messages">
            <!-- Welcome Message -->
            <div class="aivy-message aivy-message-bot">
                <div class="aivy-message-bubble">
                    <p>üëã Xin ch√†o! T√¥i l√† AIVY - AI Assistant c·ªßa IVS Learning Hub.</p>
                    <p>T√¥i c√≥ th·ªÉ gi√∫p b·∫°n:</p>
                    <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                        <li>Tr·∫£ l·ªùi c√¢u h·ªèi v·ªÅ kh√≥a h·ªçc</li>
                        <li>H·ªó tr·ª£ h·ªçc t·∫≠p v√† gi·∫£i b√†i t·∫≠p</li>
                        <li>G·ª£i √Ω c√°c kh√≥a h·ªçc ph√π h·ª£p</li>
                        <li>H·ªó tr·ª£ k·ªπ thu·∫≠t 24/7</li>
                    </ul>
                    <p>B·∫°n mu·ªën t√¥i gi√∫p g√¨?</p>
                </div>
            </div>
        </div>

        <!-- Suggestions -->
        <div class="aivy-suggestions">
            <button class="aivy-suggestion-btn" onclick="sendAIVYMessage('T√¥i c·∫ßn h·ªçc ReactJS')">
                <i class="fas fa-book"></i> T√¨m kh√≥a h·ªçc ReactJS
            </button>
            <button class="aivy-suggestion-btn" onclick="sendAIVYMessage('T√¥i c·∫ßn gi√∫p gi·∫£i b√†i t·∫≠p')">
                <i class="fas fa-question-circle"></i> Gi·∫£i b√†i t·∫≠p
            </button>
            <button class="aivy-suggestion-btn" onclick="sendAIVYMessage('L√†m sao ƒë·ªÉ c·∫£i thi·ªán k·ªπ nƒÉng?')">
                <i class="fas fa-lightbulb"></i> L·ªô tr√¨nh h·ªçc
            </button>
        </div>

        <!-- Input Area -->
        <div class="aivy-input-area">
            <div class="aivy-input-container">
                <input 
                    id="aivy-input" 
                    type="text" 
                    class="aivy-input" 
                    placeholder="H·ªèi t√¥i b·∫•t c·ª© ƒëi·ªÅu g√¨..." 
                    onkeypress="handleAIVYKeypress(event)"
                />
                <button id="aivy-send-btn" class="aivy-send-btn" onclick="sendAIVYMessage()" title="G·ª≠i">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            <p class="aivy-disclaimer">üí° AI s·∫Ω tr·∫£ l·ªùi d·ª±a tr√™n ki·∫øn th·ª©c v·ªÅ kh√≥a h·ªçc & gi√°o d·ª•c</p>
        </div>
    </div>
</div>

<style>
    /* AIVY Chatbot Styles */
    .aivy-container {
        --aivy-primary: #4c5ef7;
        --aivy-secondary: #22d3ee;
        --aivy-success: #10b981;
        --aivy-warning: #f97316;
        --aivy-bg: #0f0f0f;
        --aivy-surface: rgba(26, 26, 26, 0.95);
        --aivy-border: rgba(255, 255, 255, 0.1);
        --aivy-text: #ffffff;
        --aivy-text-secondary: #9ca3af;
    }

    /* Floating Button */
    .aivy-toggle-btn {
        position: fixed;
        bottom: 90px;
        right: 24px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--aivy-primary), var(--aivy-secondary));
        border: none;
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        box-shadow: 0 8px 24px rgba(76, 94, 247, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        z-index: 999;
    }

    .aivy-toggle-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 12px 32px rgba(76, 94, 247, 0.6);
    }

    .aivy-toggle-btn:active {
        transform: scale(0.95);
    }

    .aivy-icon {
        animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-8px); }
    }

    .aivy-badge {
        position: absolute;
        top: -8px;
        right: -8px;
        background: var(--aivy-warning);
        color: white;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 700;
        border: 2px solid var(--aivy-bg);
    }

    /* Chat Window */
    .aivy-chat-window {
        position: fixed;
        bottom: 90px;
        right: 24px;
        width: 420px;
        height: 600px;
        background: var(--aivy-surface);
        border: 1px solid var(--aivy-border);
        border-radius: 16px;
        display: flex;
        flex-direction: column;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        z-index: 998;
        opacity: 0;
        transform: scale(0.8) translateY(20px);
        pointer-events: none;
        transition: all 0.3s ease;
    }

    .aivy-chat-window.active {
        opacity: 1;
        transform: scale(1) translateY(0);
        pointer-events: auto;
    }

    /* Chat Header */
    .aivy-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1.5rem;
        border-bottom: 1px solid var(--aivy-border);
        background: linear-gradient(135deg, rgba(76, 94, 247, 0.1), rgba(34, 211, 238, 0.1));
    }

    .aivy-header-content {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex: 1;
    }

    .aivy-avatar {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--aivy-primary), var(--aivy-secondary));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.25rem;
    }

    .aivy-title-section {
        flex: 1;
    }

    .aivy-title {
        margin: 0;
        font-size: 1rem;
        font-weight: 700;
        color: var(--aivy-text);
    }

    .aivy-status {
        margin: 0;
        font-size: 0.75rem;
        color: var(--aivy-text-secondary);
    }

    .aivy-close-btn {
        background: none;
        border: none;
        color: var(--aivy-text-secondary);
        font-size: 1.25rem;
        cursor: pointer;
        transition: color 0.2s;
        padding: 0.5rem;
    }

    .aivy-close-btn:hover {
        color: var(--aivy-text);
    }

    /* Messages Area */
    .aivy-messages {
        flex: 1;
        overflow-y: auto;
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .aivy-messages::-webkit-scrollbar {
        width: 6px;
    }

    .aivy-messages::-webkit-scrollbar-track {
        background: transparent;
    }

    .aivy-messages::-webkit-scrollbar-thumb {
        background: var(--aivy-border);
        border-radius: 3px;
    }

    .aivy-messages::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.2);
    }

    .aivy-message {
        display: flex;
        animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .aivy-message-bot {
        justify-content: flex-start;
    }

    .aivy-message-user {
        justify-content: flex-end;
    }

    .aivy-message-bubble {
        max-width: 70%;
        padding: 0.75rem 1rem;
        border-radius: 12px;
        font-size: 0.875rem;
        line-height: 1.5;
    }

    .aivy-message-bot .aivy-message-bubble {
        background: rgba(76, 94, 247, 0.1);
        border: 1px solid rgba(76, 94, 247, 0.2);
        color: var(--aivy-text);
    }

    .aivy-message-user .aivy-message-bubble {
        background: linear-gradient(135deg, var(--aivy-primary), var(--aivy-secondary));
        color: white;
    }

    /* Suggestions */
    .aivy-suggestions {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        padding: 0 1rem;
        margin-bottom: 1rem;
        max-height: 120px;
        overflow-y: auto;
    }

    .aivy-suggestion-btn {
        padding: 0.75rem 1rem;
        background: rgba(76, 94, 247, 0.1);
        border: 1px solid var(--aivy-border);
        border-radius: 8px;
        color: var(--aivy-text);
        cursor: pointer;
        transition: all 0.2s;
        font-size: 0.8rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        text-align: left;
    }

    .aivy-suggestion-btn:hover {
        background: rgba(76, 94, 247, 0.2);
        border-color: var(--aivy-primary);
    }

    /* Input Area */
    .aivy-input-area {
        padding: 1rem;
        border-top: 1px solid var(--aivy-border);
        background: rgba(76, 94, 247, 0.05);
    }

    .aivy-input-container {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .aivy-input {
        flex: 1;
        padding: 0.75rem 1rem;
        background: var(--aivy-surface);
        border: 1px solid var(--aivy-border);
        border-radius: 8px;
        color: var(--aivy-text);
        font-size: 0.875rem;
        outline: none;
        transition: all 0.2s;
    }

    .aivy-input:focus {
        border-color: var(--aivy-primary);
        box-shadow: 0 0 0 3px rgba(76, 94, 247, 0.1);
    }

    .aivy-send-btn {
        width: 40px;
        height: 40px;
        padding: 0;
        background: linear-gradient(135deg, var(--aivy-primary), var(--aivy-secondary));
        border: none;
        border-radius: 8px;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
    }

    .aivy-send-btn:hover {
        transform: scale(1.05);
    }

    .aivy-send-btn:active {
        transform: scale(0.95);
    }

    .aivy-disclaimer {
        margin: 0;
        font-size: 0.7rem;
        color: var(--aivy-text-secondary);
        text-align: center;
    }

    /* Mobile Responsive */
    @media (max-width: 640px) {
        .aivy-chat-window {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            bottom: 0;
            right: 0;
            border-radius: 0;
        }

        .aivy-message-bubble {
            max-width: 85%;
        }

        .aivy-toggle-btn {
            bottom: 24px;
            right: 24px;
        }
    }

    /* Hide when on mobile navigation visible */
    @media (max-width: 768px) {
        .aivy-toggle-btn {
            bottom: 80px;
        }
    }
</style>

<script>
    // AIVY Chatbot Logic
    const AIVYChatbot = {
        init() {
            const toggleBtn = document.getElementById('aivy-toggle-btn');
            const closeBtn = document.getElementById('aivy-close-btn');
            const chatWindow = document.getElementById('aivy-chat-window');
            const sendBtn = document.getElementById('aivy-send-btn');

            if (toggleBtn) {
                toggleBtn.addEventListener('click', () => {
                    chatWindow.classList.toggle('active');
                });
            }

            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    chatWindow.classList.remove('active');
                });
            }

            if (sendBtn) {
                sendBtn.addEventListener('click', () => this.sendMessage());
            }
        },

        sendMessage() {
            const input = document.getElementById('aivy-input');
            const message = input.value.trim();

            if (!message) return;

            // Add user message
            this.addMessage(message, 'user');
            input.value = '';

            // Simulate AI response
            setTimeout(() => {
                const response = this.getAIResponse(message);
                this.addMessage(response, 'bot');
            }, 800);
        },

        addMessage(text, sender) {
            const messagesContainer = document.getElementById('aivy-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `aivy-message aivy-message-${sender}`;
            
            const bubble = document.createElement('div');
            bubble.className = 'aivy-message-bubble';
            bubble.textContent = text;

            messageDiv.appendChild(bubble);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        },

        getAIResponse(message) {
            const responses = {
                react: 'T√¥i c√≥ kh√≥a h·ªçc React.js t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao. B·∫°n c√≥ mu·ªën t√¥i g·ª£i √Ω c√°c b√†i h·ªçc ƒë·∫ßu ti√™n kh√¥ng?',
                python: 'Python l√† ng√¥n ng·ªØ tuy·ªát v·ªùi ƒë·ªÉ h·ªçc l·∫≠p tr√¨nh! Ch√∫ng t√¥i c√≥ c√°c kh√≥a h·ªçc to√†n di·ªán t·ª´ Python basics.',
                javascript: 'JavaScript l√† n·ªÅn t·∫£ng c·ªßa ph√°t tri·ªÉn web hi·ªán ƒë·∫°i. B·∫°n mu·ªën b·∫Øt ƒë·∫ßu t·ª´ ƒë√¢u?',
                kh√≥a: 'B·∫°n ƒëang t√¨m ki·∫øm kh√≥a h·ªçc v·ªÅ ƒëi·ªÅu g√¨? T√¥i c√≥ th·ªÉ g·ª£i √Ω d·ª±a tr√™n m·ª•c ti√™u c·ªßa b·∫°n.',
                gi√∫p: 'T√¥i r·∫•t vui l√≤ng gi√∫p b·∫°n! H√£y cho t√¥i bi·∫øt b·∫°n c·∫ßn gi√∫p g√¨ c·ª• th·ªÉ.',
                default: 'ƒêi·ªÅu ƒë√≥ nghe r·∫•t th√∫ v·ªã! üòä T√¥i c√≥ th·ªÉ gi√∫p b·∫°n t√¨m ki·∫øm kh√≥a h·ªçc li√™n quan ho·∫∑c tr·∫£ l·ªùi c√¢u h·ªèi v·ªÅ n√≥. B·∫°n mu·ªën t√¥i l√†m g√¨?'
            };

            const msgLower = message.toLowerCase();
            
            if (msgLower.includes('react')) return responses.react;
            if (msgLower.includes('python')) return responses.python;
            if (msgLower.includes('javascript')) return responses.javascript;
            if (msgLower.includes('kh√≥a')) return responses.kh√≥a;
            if (msgLower.includes('gi√∫p')) return responses.gi√∫p;
            
            return responses.default;
        }
    };

    // Global functions for suggestion buttons
    window.sendAIVYMessage = function(message) {
        const input = document.getElementById('aivy-input');
        if (message) {
            input.value = message;
        }
        AIVYChatbot.sendMessage();
    };

    window.handleAIVYKeypress = function(event) {
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            AIVYChatbot.sendMessage();
        }
    };

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => AIVYChatbot.init());
    } else {
        AIVYChatbot.init();
    }
</script>
